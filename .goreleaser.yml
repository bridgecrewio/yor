before:
  hooks:
  - cmd: |
    sh -c "echo \"Updating version file with new tag: $GORELEASER_CURRENT_TAG\";echo \"package common\" > src/common/version.go;echo \"\" >> src/common/version.go;echo \"const Version = \\"$GORELEASER_CURRENT_TAG\\"\" >> src/common/version.go"

builds:
  - id: yor
    goos:
      - linux
      - darwin
      - windows
    goarch:
      - 386
      - amd64
    ignore:
      - goarch: 386
        goos: darwin


brews:
  -
    name: yor-gorelease

    tap:
      owner: bridgecrewio
      name: homebrew-tap
      token: "{{ .Env.GITHUB_TOKEN }}"


#    url_template: "https://github.com/bridgecrewio/yor/releases/download/{{ .Env.GORELEASER_CURRENT_TAG }}/yor-{{ .Env.GORELEASER_CURRENT_TAG }}-darwin-amd64.tar.gz"

    commit_author:
      name: "GitHub Action"
      email: action@github.com

    homepage: "https://www.yor.io"

    description: "Extensible auto-tagger for your IaC files"
    license: "Apache-2.0"

    install: |
      bin.install "yor"

    test: |
      system "#{bin}/yor", "--help"

